import { Canvas, Meta } from "@storybook/blocks";
import * as useRotateToMove from "./useRotateToMove.stories";

<Meta of={useRotateToMove} title="useDragToMove custom Hook" />

# the `useRotateToMove` custom React hook

This is a custom React hook (aka a "headless component") that provides basic functionality to rotate a target
element around an origin inside a container. The project has no styles or components; instead you use
these hooks in your own components to add functionality.

`useRotateToMove` gives you basic functionality: it lets you drag an element around an origin, and it will
give you the angle in radians. It lets you rotate the target infinitely clockwise or anti-clockwise, and lets you
keep track of You pass it refs to a container element and a target element.

You can effect rotation either by dragging the target, or by using the mouse wheel when the pointer is over the
container.

It uses `useDragToMove` under the hood to track when the user is dragging the target, and `useWheelSpeed` to
respond to the mouse wheel being used.

## Usage

You use the `useRotateToMove` hook as follows:

```tsx
// These are used in tsx code as `ref={containerRef}` and `ref={targetRef}`
const containerRef = useRef<Element>(null);
const targetRef = useRef<Element>(null);

// these properties will be updated automatically by the custom hook
const { isDragging, isOnTarget, angle, totalAngle, fullRotations } = useRotateToMove({
  containerRef,
  targetRef
  origin: { x: 0, y: 0 }
});

// add code that updates the component based on these properties
// ...
```

`useRotateToMove` returns an object with the following properties:

- `isOnTarget` - `true` if the mouse is currently over the target
- `isDragging` - `true` if the user is touching or holding the mouse and dragging across the container area
- `angle` - The angle (in radians) between 0 and 2*pi, where 0 is at 3 o'clock, and 1/4*pi is at 6 o'clock
  (so the angle increases clockwise)
- `totalAngle` - The total angle, e.g. if you rotate past a full rotation, `angle` resets, while this keeps
  increasing or decreasing.
- `fullRotations` - The number of full rotations. Positive is clockwise, negative is anti-clockwise.

You probably want to change your component based on these values, e.g. you want to update the position of the target
element if the user is dragging it. You can do this with a `useEffect` handler that depends on the properties you
want to track:

```tsx
const [position, setPosition] = useState<Point2D | null>(null);
useEffect(() => {
  const newPosition = angleToPoint(angle, { x: 0, y: 0 }, 0.8);
  setPosition((prev) => (pointEquals(prev, newPosition) ? prev : newPosition));
}, [angle]);
```

# Example

An example using an SVG with a draggable circle that rotates around a center:

<Canvas of={useRotateToMove.UseRotateToMoveExample} />
