import { Canvas, Meta } from "@storybook/blocks";
import * as useDragToMove from "./useDragToMove.stories";

<Meta of={useDragToMove} title="useDragToMove custom Hook" />

# the `useDragToMove` custom React hook

This is a custom React hook (aka a "headless component") that provides very basic functionality to drag
a target element around inside a dragArea. The project has no styles or components; instead you use
these hooks in your own components to add functionality.

`useDragToMove` is the most basic functionality. You pass it refs to a dragArea element and a target element.
Event listeners on the dragArea track mouse or touch events, and indicates whether the user is dragging (i.e.
the user is touching or holding the mouse down in the dragArea area), whether the dragging started on the
target element, and the current position of the cursor relative to the dragArea element.

## Usage

You use the `useDragToMove` hook as follows:

```tsx
// These are used in tsx code as `ref={dragAreaRef}` and `ref={targetRef}`
const dragAreaRef = useRef<Element>(null);
const targetRef = useRef<Element>(null);

// these properties will be updated automatically by the custom hook
const { isOnTarget, isDragging, isStartDragOnTarget, cursorPosition } = useDragToMove({ dragAreaRef, targetRef });

// add code that updates the component based on these properties
// ...
```

`useDragToMove` returns an object with the following properties:

- `isOnTarget` - `true` if the mouse is currently over the target
- `isDragging` - `true` if the user is touching or holding the mouse and dragging across the dragArea area
- `isStartDragOnTarget` - `true` if the user started the dragging action while on the target dragArea. This
  differentiates between dragging actions that occur anywhere inside the dragArea, and dragging the target element
- `cursorPosition` - the `{x, y}` values of the mouse pointer or the touch event. This can be used to update the
  position of the target element. This value is relative to the dragArea element's top-left corner, e.g. when
  the user clicks in the top-left corner of the dragArea element, the position will be `{x: 0, y: 0}`.

You probably want to change your component based on these values, e.g. you want to update the position of the target
element if the user is dragging it. You can do this with a `useEffect` handler that depends on the properties you
want to track:

```tsx
useEffect(() => {
  const dragArea = dragAreaRef.current;
  const target = targetRef.current;
  if (isDragging && isStartDragOnTarget && cursorPosition && dragArea && target) {
    setPosition({
      x: cursorPosition.x - dragArea.clientTop - target.clientWidth / 2,
      y: cursorPosition.y - dragArea.clientLeft - target.clientHeight / 2
    });
  }
}, [isStartDragOnTarget, cursorPosition, isDragging]);
```

# basic useDragToMove custom hook complete example

This shows the basic functionality of the `useDragToMove` custom hook, applied to a component

<Canvas of={useDragToMove.UseDragToMoveBasicExample} />

# basic useDragToMove custom hook on an SVG component

A slightly fancier example, using an SVG with a draggable circle

<Canvas of={useDragToMove.UseDragToMoveSVGDemo} />
